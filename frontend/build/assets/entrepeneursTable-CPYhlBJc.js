import{r as i,j as e,h as G,L as D,o as T}from"./index-CSLHpH0h.js";import{C as A,a as _}from"./CCardBody-lddn-lVE.js";import{C as L}from"./CCardHeader-C_TEgKtB.js";import{C as q}from"./CForm-B1IY77re.js";import{C as y,a as C}from"./CRow-0zQLR-hW.js";import{C as v}from"./CFormControlWrapper-Q-etk-q4.js";import{C as k}from"./CFormSelect-BJEMcpwQ.js";import{C as R}from"./CFormInput-B78U5jD3.js";import{a as p}from"./index.esm-C5vQm3dE.js";import{I,u as w,w as O}from"./importExport-B06poIKe.js";import{C as B}from"./CTable-CnReKnGy.js";import"./index-BVz1XdLV.js";const P=({entrepreneurs:l,onFilterUpdate:u})=>{const m={sector:"",male:!0,female:!0,gouvernorat:"",search:""},[o,h]=i.useState(m),[E,g]=i.useState([]),[j,N]=i.useState([]),[b,S]=i.useState(!0),[r,t]=i.useState([]);i.useEffect(()=>{const a=[...new Set(l.map(d=>d.secteurActivite))],x=[...new Set(l.map(d=>d.gouvernorat))];g(a),N(x)},[l]),i.useEffect(()=>{S(o.male||o.female)},[o.male,o.female]),i.useEffect(()=>{const a=l.filter(x=>Object.values(x).some(d=>d&&d.toString().toLowerCase().includes(o.search.toLowerCase())));t(a)},[o.search,l]);const s=a=>{const{name:x,value:d}=a.target;h(F=>({...F,[x]:d}))},c=a=>{const{name:x,checked:d}=a.target;h(F=>({...F,[x]:d}))},f=()=>{h(m),u(m)},n=a=>{a.preventDefault(),u(o)};return e.jsxs(A,{className:"mb-4 shadow",children:[e.jsx(L,{className:"bg-primary text-white",children:"Filtre Avancée"}),e.jsx(_,{children:e.jsxs(q,{onSubmit:n,children:[e.jsxs(y,{className:"mb-3",children:[e.jsxs(C,{md:"4",children:[e.jsx(v,{htmlFor:"sector",children:"Secteur:"}),e.jsxs(k,{name:"sector",value:o.sector,onChange:s,children:[e.jsx("option",{value:"",children:"Toutes Secteurs"}),E.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs(C,{md:"4",children:[e.jsx(v,{children:"Genre"}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"male",name:"male",checked:o.male,onChange:c}),e.jsx("label",{htmlFor:"male",className:"mx-2",children:"Homme"}),e.jsx("input",{type:"checkbox",id:"female",name:"female",checked:o.female,onChange:c}),e.jsx("label",{htmlFor:"female",className:"mx-2",children:"Femme"})]})]})]}),e.jsx(y,{children:e.jsxs(C,{md:"4",children:[e.jsx(v,{htmlFor:"gouvernorat",children:"Gouvernorat:"}),e.jsxs(k,{name:"gouvernorat",value:o.gouvernorat,onChange:s,children:[e.jsx("option",{value:"",children:"Touts Gouvernorats"}),j.map(a=>e.jsx("option",{value:a,children:a},a))]})]})}),e.jsx(y,{children:e.jsxs(C,{md:"12",children:[e.jsx(v,{htmlFor:"search",children:"Recherche:"}),e.jsx("div",{className:"input-group",children:e.jsx(R,{type:"text",id:"search",name:"search",className:"form-control",placeholder:"Nom du l'Entrepreneur / Startup / Email",value:o.search,onChange:s})})]})}),e.jsxs("div",{className:"d-flex justify-content-start gap-2 mt-3",children:[e.jsx(p,{type:"submit",color:"primary",disabled:!b,children:"Appliquer Filtre"}),e.jsx(p,{type:"button",color:"secondary",onClick:f,children:"Annuler"})]})]})})]})},H=({onExportAll:l,onExportSelected:u,selectedCount:m})=>{const o=()=>{l&&l()},h=()=>{u&&u()};return e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx(p,{color:"primary",className:"m-2",onClick:o,children:"Export All"}),e.jsx(p,{color:"primary",className:"m-2",onClick:h,children:"Export Selected"})]}),e.jsx("div",{children:e.jsxs("p",{children:[m," selected"]})})]})},ee=()=>{const l=G(r=>r.entrepreneurs.entrepreneurs),[u,m]=i.useState(l),[o,h]=i.useState([]);i.useEffect(()=>{m(l)},[l]);const E=r=>{let t=l;if(r.sector&&(t=t.filter(s=>s.secteurActivite===r.sector)),(r.male||r.female)&&(t=t.filter(s=>r.male&&r.female?!0:r.male?s.genre==="homme":r.female?s.genre==="femme":!1)),r.gouvernorat&&(t=t.filter(s=>s.gouvernorat===r.gouvernorat)),r.search){const s=r.search.toLowerCase();t=t.filter(c=>c.nom&&c.nom.toLowerCase().includes(s)||c.prenom&&c.prenom.toLowerCase().includes(s)||c.email&&c.email.toLowerCase().includes(s)||c.projName&&c.projName.toLowerCase().includes(s))}m(t)},g=r=>{h(t=>t.includes(r)?t.filter(s=>s!==r):[...t,r])},j=(r,t)=>{const s=r.map(n=>({Nom:n.nom,Prénom:n.prenom,Adresse:n.adresse,Email:n.email,"Date de Naissance":n.dateDeNaissance,Région:n.region,Genre:n.gender,"Nom de Startup":n.startupName,Description:n.description,Gouvernorat:n.gouvernorat,"Secteur d'activités":n.secteurActivites,"Nombre de Cofondateurs":n.nombreCofondateurs,"Nombre de Cofondateurs Femmes":n.nombreCofondateursFemmes,"Créée ou Non":n.creeeOuNon,"Forme Juridique":n.formeJuridique,"Nombre d'emplois Créés":n.nombreEmploisCrees,"Coût du Projet":n.coutProjet})),c=w.json_to_sheet(s),f=w.book_new();w.book_append_sheet(f,c,"Entrepreneurs"),O(f,t)},N=()=>{j(l,"all_entrepreneurs.xlsx")},b=()=>{const r=u.filter(t=>o.includes(t._id));j(r,"selected_entrepreneurs.xlsx")},S=async r=>{try{console.log(r),await T.delete(`/deleteEntrepreneur/${r}`);const t=l.filter(s=>s._id!==r);m(t),h(s=>s.filter(c=>c!==r))}catch(t){console.error("Error deleting entrepreneur:",t)}};return e.jsxs("div",{children:[e.jsx(P,{entrepreneurs:l,onFilterUpdate:E}),e.jsxs("div",{className:"d-flex justify-content-end mt-2 ",children:[e.jsx(I,{}),e.jsx(H,{onExportAll:N,onExportSelected:b,selectedCount:o.length})]}),e.jsxs(A,{className:"mt-2",children:[e.jsx(L,{className:"bg-dark text-light",children:"Entrepreneurs"}),e.jsx(_,{children:e.jsxs(B,{responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Nom du l'Entrepreneur"}),e.jsx("th",{children:"Nom du Startup"}),e.jsx("th",{children:"Secteur d'Activité"}),e.jsx("th",{children:"Email"}),e.jsx("th",{})," "]})}),e.jsx("tbody",{children:u.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:o.includes(r._id),onChange:()=>g(r._id)})}),e.jsxs("td",{children:[r.nom," ",r.prenom]}),e.jsx("td",{children:r.projName}),e.jsx("td",{children:r.secteurActivite}),e.jsx("td",{children:r.email}),e.jsxs("td",{children:[e.jsx(D,{to:`${r._id}`,children:e.jsx(p,{color:"primary",children:"See More"})}),e.jsx(p,{color:"danger",className:"m-1",onClick:()=>S(r._id),children:"Delete"})]})]},r._id))})]})})]})]})};export{ee as default};
