import{r as n,R as he,c as xe,P as q,b as L,j as e,u as W,t as O,e as pe,n as ue,B as je,D as ge,E as ae,F as U,G as be,y as fe,d as Ne,H as ye}from"./index-a7KGE-e6.js";import Ce from"./Program-BLwOn8tl.js";import{G as ve}from"./iconBase-D5m7GyVH.js";import{Q as we,B as te}from"./react-toastify.esm-CY7Ry2WD.js";/* empty css                      */import{C as E,a as N}from"./CRow-BQnu_IYt.js";import{C as Te}from"./CFormCheck-Tpf9b-93.js";import{C as k,a as D}from"./CCardBody-D5i9NawC.js";import{C as P}from"./CCardHeader-CAfOLN-A.js";import{C as Z,P as ke}from"./ProgramCard-CFyswKE7.js";import{b as f,C as De,a as Se}from"./index.es-CZjOsi7n.js";import{C as b}from"./CFormInput-mEw4xuuC.js";import{C as ne}from"./CForm-DYpaEfOq.js";import{C as ce}from"./CFormTextarea-CeG6DJII.js";import{H as Pe}from"./index-DZEGC-Ug.js";import{C as Fe}from"./index.esm-v2cEaM7o.js";import{C as X,a as Y,b as ee,c as se,d as oe}from"./DefaultLayout-DlGbFgig.js";import{e as Ie,f as Le}from"./index-BDYsmWCK.js";import{C as T}from"./CInputGroup-g_9AzE1w.js";import{C as V}from"./CInputGroupText-C7tnQUrW.js";import{C as de}from"./CFormSelect-D2T55IT6.js";import{C as Ee,a as Ae,b as le,c as J,d as Re,e as Q}from"./CTable-CKL_tAhm.js";import{C as Ve,a as re}from"./CPaginationItem-DGAkdgTv.js";import"./index-DWz52DHX.js";import"./isObject-CbYY3a9i.js";import"./ProgramsStatistics-Cc8W5tJx.js";import"./chart-C4pU69U9.js";var G=n.forwardRef(function(a,t){var l,r=a.children,d=a.as,y=d===void 0?"ul":d,m=a.className,h=a.flush,p=a.layout;return he.createElement(y,{className:xe("list-group",(l={"list-group-flush":h},l["list-group-".concat(p)]=p,l),m),ref:t},r)});G.propTypes={as:q.elementType,children:q.node,className:q.string,flush:q.bool,layout:q.oneOf(["horizontal","horizontal-sm","horizontal-md","horizontal-lg","horizontal-xl","horizontal-xxl"])};G.displayName="CListGroup";var _e=["512 512","<path fill='var(--ci-primary-color, currentColor)' d='M472,96H384V40H352V96H160V40H128V96H40a24.028,24.028,0,0,0-24,24V456a24.028,24.028,0,0,0,24,24H472a24.028,24.028,0,0,0,24-24V120A24.028,24.028,0,0,0,472,96Zm-8,352H48V128h80v40h32V128H352v40h32V128h80Z' class='ci-primary'/><rect width='32' height='32' x='112' y='224' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='200' y='224' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='280' y='224' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='368' y='224' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='112' y='296' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='200' y='296' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='280' y='296' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='368' y='296' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='112' y='368' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='200' y='368' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='280' y='368' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/><rect width='32' height='32' x='368' y='368' fill='var(--ci-primary-color, currentColor)' class='ci-primary'/>"];function me(){const a=L(t=>t.userData.userData);return e.jsx("div",{className:"container my-5 py-5",style:{maxWidth:"100%"},children:e.jsx("div",{className:"row d-flex justify-content-center",children:e.jsx("div",{className:"col-md-12 col-lg-10 col-xl-12",children:e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"card-body",style:{overflow:"auto",maxHeight:"300px"},children:[e.jsxs("div",{className:"card-container",style:{marginBottom:"20px"},children:[e.jsxs("div",{className:"d-flex flex-start align-items-center",children:[e.jsx("img",{className:"rounded-circle shadow-1-strong me-3",src:"https://mdbcdn.b-cdn.net/img/Photos/Avatars/img%20(19).webp",alt:"avatar",width:"60",height:"60"}),e.jsxs("div",{children:[e.jsx("h6",{className:"fw-bold text-primary mb-1",children:"Lily Coleman"}),e.jsx("p",{className:"text-muted small mb-0",children:"Shared publicly - Jan 2020"})]})]}),e.jsx("p",{className:"mt-3 mb-4 pb-2",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip consequat."}),e.jsxs("div",{className:"small d-flex justify-content-start",children:[e.jsxs("a",{href:"#!",className:"d-flex align-items-center me-3",children:[e.jsx("i",{className:"far fa-thumbs-up me-2"}),e.jsx("p",{className:"mb-0",children:"Like"})]}),e.jsxs("a",{href:"#!",className:"d-flex align-items-center me-3",children:[e.jsx("i",{className:"far fa-comment-dots me-2"}),e.jsx("p",{className:"mb-0",children:"Comment"})]}),e.jsxs("a",{href:"#!",className:"d-flex align-items-center me-3",children:[e.jsx("i",{className:"fas fa-share me-2"}),e.jsx("p",{className:"mb-0",children:"Share"})]})]})]}),e.jsxs("div",{className:"card-container",children:[e.jsxs("div",{className:"d-flex flex-start align-items-center",children:[e.jsx("img",{className:"rounded-circle shadow-1-strong me-3",src:"https://mdbcdn.b-cdn.net/img/Photos/Avatars/img%20(19).webp",alt:"avatar",width:"60",height:"60"}),e.jsxs("div",{children:[e.jsx("h6",{className:"fw-bold text-primary mb-1",children:"Lily Coleman"}),e.jsx("p",{className:"text-muted small mb-0",children:"Shared publicly - Jan 2020"})]})]}),e.jsx("p",{className:"mt-3 mb-4 pb-2",children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip consequat."}),e.jsxs("div",{className:"small d-flex justify-content-start",children:[e.jsxs("a",{href:"#!",className:"d-flex align-items-center me-3",children:[e.jsx("i",{className:"far fa-thumbs-up me-2"}),e.jsx("p",{className:"mb-0",children:"Like"})]}),e.jsxs("a",{href:"#!",className:"d-flex align-items-center me-3",children:[e.jsx("i",{className:"far fa-comment-dots me-2"}),e.jsx("p",{className:"mb-0",children:"Comment"})]}),e.jsxs("a",{href:"#!",className:"d-flex align-items-center me-3",children:[e.jsx("i",{className:"fas fa-share me-2"}),e.jsx("p",{className:"mb-0",children:"Share"})]})]})]})]}),e.jsxs("div",{className:"card-footer py-3 border-0",style:{backgroundColor:"#f8f9fa"},children:[e.jsxs("div",{className:"d-flex flex-start w-100",children:[e.jsx("img",{className:"rounded-circle shadow-1-strong me-3",src:a.image,alt:"avatar",width:"40",height:"40"}),e.jsxs("div",{"data-mdb-input-init":!0,className:"form-outline w-100",children:[e.jsx("textarea",{className:"form-control",id:"textAreaExample",rows:"4",style:{background:"#fff"}}),e.jsx("label",{className:"form-label",htmlFor:"textAreaExample",children:"Message"})]})]}),e.jsxs("div",{className:"float-end mt-2 pt-1",children:[e.jsx("button",{type:"button","data-mdb-button-init":!0,"data-mdb-ripple-init":!0,className:"btn btn-primary btn-sm",children:"Post comment"}),e.jsx("button",{type:"button","data-mdb-button-init":!0,"data-mdb-ripple-init":!0,className:"btn btn-outline-primary btn-sm",children:"Cancel"})]})]})]})})})})}const Be=""+new URL("details-7dNbQ7Pl.webp",import.meta.url).href;function ie(a){return ve({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"m289.94 256 95-95A24 24 0 0 0 351 127l-95 95-95-95a24 24 0 0 0-34 34l95 95-95 95a24 24 0 1 0 34 34l95-95 95 95a24 24 0 0 0 34-34z"},child:[]}]})(a)}const He=({task:a})=>{const t=W(),[l,r]=n.useState(a),[d,y]=n.useState(""),[m,h]=n.useState(""),[p,j]=n.useState(""),[g,S]=n.useState(""),[u,F]=n.useState("");n.useState("");const[o,C]=n.useState(null),[v,A]=n.useState(a.status==="completed"?"Task completed":"Task in progress");n.useEffect(()=>{console.log("Task Prop:",a),console.log("Current Task:",l)},[a,l]);const I=()=>{if(a.status==="inProgress"&&a.deliverables.length===0){alert("Please add a deliverable before changing the status");return}let s="";a.status==="completed"?s="Task in progress":s="Task completed";const i={...a,status:a.status==="completed"?"inProgress":"completed"};t(O({taskId:a._id,taskData:i})),r(i),A(s)},w=s=>{te.error(`The ${s} field is required.`,{autoClose:3e3})},_=s=>{window.open(s,"_blank")},R=()=>{if(d==="")return w("Kpi Label");if(m==="")return w("Kpi Value");const s={...a,kpis:[...a.kpis,{label:d,count:m}]};t(O({taskId:a._id,taskData:s})),r(s)},B=async s=>{if(s.preventDefault(),p==="")return w("Deliverable Name");if(!o)return w("Deliverable File");try{const i=new FormData;i.append("file",o),console.log("Uploading file:",o);const c=await pe.post("https://redboost-65f83dc8cbf1.herokuapp.com/upload",i,{headers:{"Content-Type":"multipart/form-data"}});console.log("Upload response:",c.data);const x={...a,deliverables:[...a.deliverables,{fileName:p||o.name,fileUrl:c.data.secure_url}]};t(O({taskId:a._id,taskData:x})),r(x),j(""),C(null)}catch(i){console.error("Error uploading file:",i),te.error("Failed to upload file. Please try again.")}},K=()=>{if(g==="")return w("Rapport Title");if(u==="")return w("Rapport Text");const s={...a,reports:[...a.reports,{label:g,count:u}]};t(O({taskId:a._id,taskData:s})),r(s)},H=s=>{const i=["primary","secondary","success","danger","warning","info","light","dark"];return i[s%i.length]},z=s=>!isNaN(Date.parse(s)),$=s=>z(s)?new Date(s).toLocaleDateString("en-US",{day:"2-digit",month:"2-digit",year:"numeric"}):"";return e.jsxs(e.Fragment,{children:[e.jsx(we,{}),e.jsxs(E,{children:[e.jsx(N,{children:e.jsx("div",{className:"card mb-3",style:{maxWidth:"540px"},children:e.jsxs("div",{className:"row g-0",children:[e.jsx("div",{className:"col-md-4",children:e.jsx("img",{src:Be,alt:"Trendy Pants and Shoes",className:"img-fluid rounded-start"})}),e.jsx("div",{className:"col-md-8",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:"Task Details"}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"Task Name:"})," ",l.taskName]}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"Task Owner:"})," ",l.taskOwner]}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"Target Date:"})," ",l.endDate?$(l.endDate):"No target date set"]}),e.jsxs("p",{className:"card-text",children:[e.jsx("strong",{children:"Status:"})," ",l.status]}),a.status==="inProgress"?e.jsx(Te,{className:"mb-3",style:{display:a.status==="notStarted"?"none":"block"},id:"flexCheckChecked",label:"I have Completed The Task",checked:a.status==="completed",onChange:I}):e.jsxs("p",{className:" text-center text-success",children:["this Task is ",l.status]})]})})]})})}),e.jsx(N,{children:e.jsxs(k,{children:[e.jsx(P,{className:"bg-dark text-light",children:"Resources"}),e.jsx(D,{children:e.jsxs("div",{children:[e.jsxs("h5",{children:[l.taskName," Resources:"]}),e.jsx(G,{children:l.resources.map((s,i)=>e.jsx(Z,{children:e.jsx(f,{href:s.url,download:!0,color:"link",children:s.fileName})},i))})]})})]})})]}),e.jsxs(k,{className:"mt-3 mb-3",children:[e.jsx(P,{className:"bg-dark text-light",children:"Sections"}),e.jsxs(D,{children:[e.jsxs(k,{className:"mt-3 mb-3",children:[e.jsx(P,{className:"bg-info text-light",children:"KPIs"}),e.jsx(D,{children:e.jsxs(G,{children:[e.jsx("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center"},children:l.kpis.map((s,i)=>e.jsxs("div",{className:`card text-bg-${H(i)} mb-3`,style:{minWidth:"260px",marginRight:"10px"},children:[e.jsxs("div",{className:"card-header",style:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:["KPI-",i," ",e.jsx(ie,{})]}),e.jsxs("div",{className:"card-body",children:[e.jsx("h5",{className:"card-title",children:s.label}),e.jsx("p",{className:"card-text",children:s.count})]})]},i))}),e.jsxs(Z,{children:[e.jsx("label",{htmlFor:"newKpiLabel",children:"Label:"}),e.jsx(b,{id:"newKpiLabel",placeholder:"KPI Label",value:d,onChange:s=>y(s.target.value),className:"mt-3 mb-3"}),e.jsx("label",{htmlFor:"newKpiValue",children:"Value:"}),e.jsx(b,{id:"newKpiValue",placeholder:"KPI Value",value:m,onChange:s=>h(s.target.value),className:"mt-3 mb-3"}),e.jsx(f,{style:{backgroundColor:"#00cc99"},onClick:()=>R(),className:"mt-3 mb-3",children:"Add KPI"})]})]})})]}),e.jsxs(k,{className:"mt-3 mb-3",children:[e.jsx(P,{className:"bg-info text-light",children:"Documents"}),e.jsx(D,{children:e.jsxs(G,{children:[l.deliverables.map((s,i)=>e.jsx(Z,{children:e.jsx(f,{onClick:()=>_(s.fileUrl),color:"link",children:s.fileName})},i)),e.jsx(Z,{children:e.jsxs(ne,{onSubmit:B,children:[e.jsx("label",{htmlFor:"newDeliverableName",children:"Name:"}),e.jsx(b,{id:"newDeliverableName",placeholder:"Deliverable Name",value:p,onChange:s=>j(s.target.value)}),e.jsx("label",{htmlFor:"newDeliverableFile",className:"mt-3 mb-3",children:"Upload File:"}),e.jsx("input",{id:"newDeliverableFile",name:"deliverableFile",type:"file",onChange:s=>{console.log("Selected deliverable file:",s.target.files[0]),C(s.target.files[0])}}),e.jsx(f,{style:{backgroundColor:"#00cc99"},type:"submit",className:"mt-3 mb-3",children:"Add Deliverable"})]})})]})})]}),e.jsxs(k,{className:"mt-3 mb-3",children:[e.jsx(P,{className:"bg-info text-light",children:"Reporting Section"}),e.jsx("div",{style:{display:"flex",flexWrap:"wrap",alignItems:"center",justifyContent:"center",padding:"20px"},children:l.reports.map((s,i)=>e.jsxs("div",{style:{minWidth:"300px",margin:"10px"},className:`card radius-10 border-start border-0 border-3 border-${H(i)} shadow`,children:[e.jsx(ie,{style:{position:"absolute",top:"0",right:"0",fontSize:"20px",margin:"5px"}}),e.jsx("div",{className:"card-body",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"mb-0 text-secondary",children:s.label}),e.jsx("p",{className:"mb-0 font-13",children:s.count})]}),e.jsx("div",{className:"widgets-icons-2 rounded-circle bg-gradient-ohhappiness text-white ms-auto",children:e.jsx("i",{className:"fa fa-bar-chart"})})]})})]}))}),e.jsxs(D,{children:[e.jsx(b,{placeholder:"Title",value:g,onChange:s=>S(s.target.value),className:"mb-3"}),e.jsx(ce,{placeholder:"Text",value:u,onChange:s=>F(s.target.value),className:"mt-3 mb-3"}),e.jsx(f,{style:{backgroundColor:"#00cc99"},onClick:()=>K(),className:"mt-3 mb-3",children:"Add Reporting Section"})]})]}),e.jsxs(k,{className:"mt-3 mb-3",children:[e.jsx(P,{className:"bg-info text-light",children:"Comment Section"}),e.jsx(D,{children:e.jsx(me,{})})]})]})]})]})};function Me({selectedTask:a,setSelectedtask:t}){const l=n.useRef(null),r=m=>{const h=m.target.files[0];if(!h)return;const p={name:h.name,size:h.size};t(j=>({...j,uploadFiles:[...j.uploadFiles,p]}))},d=()=>{l.current.click()},y=m=>{t(h=>({...h,uploadFiles:h.uploadFiles.filter((p,j)=>j!==m)}))};return e.jsxs("div",{className:"upload-box",children:[e.jsxs("form",{action:"",onClick:d,children:[e.jsx("input",{type:"file",className:"file-upload-input",name:"file",hidden:!0,ref:l,onChange:r}),e.jsx("div",{className:"icon",children:e.jsx(Ie,{className:"cloud-icon",style:{color:"#0c77ad"}})}),e.jsx("p",{children:"Browse File To Upload"})]}),e.jsx("section",{className:"uploaded-area",children:a.uploadFiles.map((m,h)=>e.jsx("li",{className:"row",onClick:()=>y(h),children:e.jsxs("div",{className:"content-upload",children:[e.jsx("i",{children:e.jsx(Le,{})}),e.jsx("div",{className:"details",children:e.jsx("span",{className:"name",children:m.name})})]})},h))})]})}function Ue({visible:a,setVisible:t,selectedTask:l,setSelectedtask:r}){return e.jsxs(X,{visible:a,onClose:()=>t(!1),"aria-labelledby":"LiveDemoExampleLabel",backdrop:"static",children:[e.jsx(Y,{closeButton:!0,children:e.jsx(ee,{id:"LiveDemoExampleLabel",children:"Edit Card"})}),e.jsxs(se,{style:{height:"450px",overflow:"auto"},className:"modal-body",children:[e.jsx("div",{className:"mb-3",children:e.jsx(b,{type:"text",id:"taskTitle",placeholder:"Task Title","aria-describedby":"taskTitleHelpInline",value:l.taskName})}),e.jsx("div",{className:"mb-3",children:e.jsx(b,{type:"date",id:"taskDate",placeholder:"Task Date",value:l.targetDate})})]}),e.jsxs(oe,{children:[e.jsx(f,{color:"danger",children:"cancel"}),e.jsx(f,{color:"primary",children:"Save"})]})]})}function Ke(){return e.jsxs("div",{style:{display:"flex",flexWrap:"wrap"},children:[e.jsx("div",{className:"card bg-success text-white m-2",style:{width:"300px"},children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:"This is a title"}),e.jsx("p",{className:"card-text",children:"This is body text inside my Bootstrap card."})]})}),e.jsx("div",{className:"card bg-danger text-white m-2",style:{width:"300px"},children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:"This is a title"}),e.jsx("p",{className:"card-text",children:"This is body text inside my Bootstrap card."})]})}),e.jsx("div",{className:"card bg-warning text-white m-2",style:{width:"300px"},children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:"This is a title"}),e.jsx("p",{className:"card-text",children:"This is body text inside my Bootstrap card."})]})}),e.jsx("div",{className:"card bg-secondarytext-white m-2",style:{width:"300px"},children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"card-title",children:"This is a title"}),e.jsx("p",{className:"card-text",children:"This is body text inside my Bootstrap card."})]})})]})}function ze({open:a,setOpen:t,selectedTask:l}){const r=()=>{t(!1)};return e.jsxs(X,{fullscreen:!0,visible:a,onClose:r,"aria-labelledby":"FullscreenExample1",children:[e.jsx(Y,{children:e.jsx(ee,{id:"FullscreenExample1",children:l.title})}),e.jsxs(se,{style:{backgroundColor:"#eee"},children:[e.jsxs(E,{className:"mb-0",children:[e.jsx(N,{xs:12,md:6,children:e.jsx(Ke,{selectedTask:l})}),e.jsx(N,{xs:12,md:6,children:e.jsx(Me,{})})]}),e.jsx(E,{className:"mb-0",children:e.jsx(me,{})})]})]})}function $e({open:a,setOpen:t,handleAddTask:l,activity:r}){const[d,y]=n.useState(""),[m,h]=n.useState(""),[p,j]=n.useState(""),[g,S]=n.useState(""),u=L(o=>o.usersSlice.users),F=o=>{if(o.preventDefault(),!d||!m||!p||!g)alert("All fields are required");else{const C=new Date;C.setHours(0,0,0,0);const v=new Date(m);v.setHours(0,0,0,0);const A={taskName:d,startDate:m,endDate:p,status:v>C?"notStarted":"inProgress",color:v>C?"blue":"pink",taskOwner:g};l(A),t(!1)}};return e.jsx(e.Fragment,{children:e.jsxs(X,{visible:a,onClose:()=>t(!1),"aria-labelledby":"LiveDemoExampleLabel",backdrop:"static",children:[e.jsx(Y,{onClose:()=>t(!1),children:e.jsx(ee,{id:"LiveDemoExampleLabel",children:"Add Task"})}),e.jsxs(se,{children:[e.jsx(b,{label:"Task Name:",className:"mb-3",type:"text",id:"name",name:"name",placeholder:"Task Name",value:d,onChange:o=>y(o.target.value)}),e.jsxs(T,{className:"mb-3",children:[e.jsx(V,{id:"basic-addon2",children:"Start Date"}),e.jsx(b,{type:"date",id:"start date",placeholder:"Enter start date",value:m,onChange:o=>h(o.target.value)})]}),e.jsxs(T,{className:"mb-3",children:[e.jsx(V,{id:"basic-addon2",children:"End Date"}),e.jsx(b,{type:"date",id:"end date",placeholder:"Enter end date",value:p,onChange:o=>j(o.target.value)})]}),e.jsx(T,{className:"mb-3",children:e.jsxs(de,{"aria-label":"The Task Owner",onChange:o=>S(o.target.value),value:g,children:[e.jsx("option",{children:"Choose The Task Owner"}),u.map(o=>e.jsx("option",{value:o._id,children:o.username},o._id))]})})]}),e.jsxs(oe,{children:[e.jsx(f,{color:"danger",onClick:()=>t(!1),children:"Close"}),e.jsx(f,{color:"primary",onClick:F,children:"Add"})]})]})})}const M=({status:a,tasks:t,color:l})=>e.jsx(N,{xs:12,md:4,children:e.jsxs(k,{className:"mb-3",style:{height:"400px"},children:[e.jsx(P,{className:"text-light",style:{backgroundColor:l,display:"flex",alignItems:"center",justifyContent:"space-between"},children:a}),e.jsx(D,{style:{overflow:"auto"},children:t.map((r,d)=>{if(r.status===a)return e.jsx("div",{className:"container",children:e.jsxs("div",{onClick:()=>handleModalVisibility(r),className:"card border border-success shadow mb-3",style:{maxWidth:"400px"},children:[e.jsx("div",{className:"card-header",children:e.jsx("strong",{children:r.taskName})}),e.jsx("div",{className:"card-body",children:e.jsx("div",{className:"d-flex justify-content-between align-items-center mt-3",children:e.jsxs("div",{className:"text-muted",children:[e.jsx(Se,{icon:_e,className:"mr-1"}),new Date(r.endDate).toLocaleDateString()]})})})]})},d)})})]})});function qe({activity:a,tasks:t}){const l=ue(),[r,d]=n.useState(!1),[y,m]=n.useState(!1),[h,p]=n.useState(null),[j,g]=n.useState(!1),S=4,[u,F]=n.useState(1),o=u*S,C=o-S,v=t.slice(C,o),A=W(),I=Math.ceil(t.length/S),w=()=>{u>1&&F(u-1)},_=()=>{u<I&&F(u+1)},R=c=>{const x={...c,xpPoints:0,resources:[],deliverables:[],kpis:[],activityId:a._id};console.log(x),A(je(x)),g(!1)},B=()=>{let c=0;return t.map(x=>{x.status==="valid"&&c++}),c},K=()=>{let c=0;return t.map(x=>{x.status==="inProgress"&&c++}),c},H=()=>{let c=0;return t.map(x=>{x.status==="completed"&&c++}),c},z=()=>{let c=0;return t.map(x=>{x.status==="notStarted"&&c++}),c},$=()=>{let c=0;return t.map(x=>{x.status==="cancelled"&&c++}),c},s=()=>{let c=0;return t.map(x=>{x.status==="expired"&&c++}),c},i=c=>{const x=window.location.pathname;l(`${x}/${c._id}`)};return e.jsxs(e.Fragment,{children:[j&&e.jsx($e,{setOpen:g,open:j,handleAddTask:R,activity:a}),e.jsxs(De,{style:{padding:"20px"},className:"mt-4",children:[h&&e.jsx(Ue,{visible:r,setVisible:d,selectedTask:h,setSelectedtask:p}),h&&e.jsx(ze,{open:y,setOpen:m,selectedTask:h}),e.jsx(E,{children:e.jsx(N,{children:e.jsx(f,{onClick:()=>g(!0),className:"mb-3",rounded:"lg",color:"primary",style:{float:"right"},children:"Add Task"})})}),e.jsxs(E,{className:"mb-3",children:[e.jsx(M,{status:"notStarted",tasks:t,color:"#006666"}),e.jsx(M,{status:"inProgress",tasks:t,color:"#fb5858"}),e.jsx(M,{status:"completed",tasks:t,color:"#0ca279"}),e.jsx(M,{status:"valid",tasks:t,color:"#074a38"}),e.jsx(M,{status:"expired",tasks:t,color:"#dab600"}),e.jsx(M,{status:"cancelled",tasks:t,color:"grey"})]}),e.jsxs(E,{children:[e.jsx(N,{children:e.jsxs(k,{className:"mb-3",children:[e.jsx(P,{className:"bg-dark text-light",children:"Recent Tasks"}),e.jsxs(D,{children:[e.jsxs(Ee,{striped:!0,responsive:!0,className:"text-center",children:[e.jsx(Ae,{children:e.jsxs(le,{children:[e.jsx(J,{scope:"col",children:"Target Date"}),e.jsx(J,{scope:"col",children:"Task Name"}),e.jsx(J,{scope:"col",children:"Status"}),e.jsx(J,{scope:"col",children:"View"})]})}),e.jsx(Re,{children:v.map((c,x)=>e.jsxs(le,{children:[e.jsx(Q,{children:new Date(c.endDate).toLocaleDateString()}),e.jsx(Q,{children:c.taskName}),e.jsx(Q,{children:c.status}),e.jsx(Q,{children:e.jsx(Pe,{role:"button",style:{fontSize:"25px",color:"#4CAF50"},onClick:()=>i(c)})})]},x))})]}),e.jsxs(Ve,{pages:I,align:"center",children:[e.jsx(re,{onClick:w,disabled:u<=1,"aria-label":"Previous",children:"Previous"}),e.jsx(re,{onClick:_,disabled:u>=I,"aria-label":"Next",children:"Next"})]})]})]})}),e.jsx(N,{children:e.jsxs(k,{className:"mb-3",children:[e.jsx(P,{className:"bg-dark text-light",children:"Task Progress"}),e.jsx(D,{children:e.jsx(Fe,{type:"bar",data:{labels:["Total Tasks","In Progress","Completed","Valid","Expired","Cancelled","Not Started"],datasets:[{label:"Task Progress",backgroundColor:["pink, lightgreen, green, yellow,grey,blue"],data:[t.length,K(),H(),B(),s(),$(),z()]}]},labels:"Status",options:{plugins:{legend:{labels:{color:"#adb7c5"}}},scales:{x:{grid:{color:"#adb7c5"},ticks:{color:"#adb7c5"}},y:{grid:{color:"#adb7c5"},ticks:{color:"#adb7c5"}}}}})})]})})]})]})]})}function Ge({activity:a}){const t=W(),l=L(r=>r.task.tasksByActivityId);return n.useEffect(()=>{t(ge(a._id))},[t,a._id]),e.jsxs(ae,{children:[e.jsx(U,{path:"/",element:e.jsx(qe,{activity:a,tasks:l})}),l.map(r=>e.jsx(U,{path:`${r._id}/*`,element:e.jsx(He,{task:r})},r._id))]})}const We=({program:a})=>{console.log("ProgramWithActivities rendered");const t=W(),l=L(r=>r.activity.activitiesByProgramId||[]);return n.useEffect(()=>{t(be(a._id)).then(r=>{r!=null&&r.payload&&t(fe(r.payload.map(d=>({path:`/Monitoring/${encodeURIComponent(a.programTitle)}/${encodeURIComponent(d.name)}`,name:d.name,activityId:d._id}))))})},[t,a._id,a.programTitle]),e.jsxs(ae,{children:[e.jsx(U,{path:"/",element:e.jsx(Ce,{activities:l,program:a})}),l.map(r=>e.jsx(U,{path:`${r._id}/*`,element:e.jsx(Ge,{activity:r})},r._id))]})},Oe=2097152;function Ze(){const a=W(),t=L(s=>s.usersSlice.users),l=L(s=>s.userData.userData),r=L(s=>s.programsSlice.programs);console.log("users",t),console.log("currentUser",l);const[d,y]=n.useState(""),[m,h]=n.useState(null),[p,j]=n.useState(""),[g,S]=n.useState(""),[u,F]=n.useState(""),[o,C]=n.useState(""),[v,A]=n.useState(""),[I,w]=n.useState(""),[_,R]=n.useState(!1);console.log("programs",r);const B=n.useRef(null),K=s=>{s<u?alert("End date must be greater than start date"):C(s)},H=()=>{B.current.click()},z=()=>{if(m===null||p===""||g===""||u===""||o===""||v===""||I===""){alert("Please fill all the fields");return}const s=new FormData;console.log("logo",m),s.append("logo",m),Ne.post("/uploadLogo",s,{headers:{"Content-Type":"multipart/form-data"}}).then(i=>{if(i.status===200){console.log("response",i);const c={programTitle:p,programDescription:g,startDate:u,endDate:o,budget:v,authorizedUsers:[I],logo:i.data.secure_url};a(ye(c))}}).catch(i=>{console.log("error",i)}),R(!1)},$=s=>{const i=s.target.files[0];if(i&&i.size>Oe){alert("File size exceeds the maximum limit of 2MB");return}h(i),y(i.name)};return e.jsxs(e.Fragment,{children:[e.jsxs(X,{"fullscreen-md-down":"true",visible:_,onClose:()=>R(!1),"aria-labelledby":"FullscreenExample1",children:[e.jsx(Y,{children:e.jsx(ee,{id:"FullscreenExample1",children:"Add Program"})}),e.jsx(se,{children:e.jsxs(ne,{children:[e.jsxs(T,{className:"mb-3 border rounded",children:[e.jsx(f,{color:"primary",onClick:H,children:"Choose Logo"}),e.jsxs(N,{className:"d-flex align-items-center justify-content-center",children:[e.jsx(b,{ref:B,accept:"image/*",style:{display:"none"},type:"file",id:"logo",name:"logo",placeholder:"Enter logo",onChange:$}),!d&&e.jsx("span",{className:"logo-name",children:"..."}),d&&e.jsx("span",{className:"logo-name",children:d})]})]}),e.jsxs(T,{className:"mb-3",children:[e.jsx(V,{id:"basic-addon2",children:"@"}),e.jsx(b,{id:"program name",placeholder:"Program Name","aria-label":"Program Name","aria-describedby":"basic-addon2",onChange:s=>j(s.target.value)})]}),e.jsx(T,{className:"mb-3",children:e.jsx(ce,{type:"text-area",id:"program description",placeholder:"Program Description","aria-label":"Program Description","aria-describedby":"basic-addon2",onChange:s=>S(s.target.value)})}),e.jsxs(N,{className:"mb-3 d-flex gap-3",children:[e.jsxs(T,{children:[e.jsx(V,{id:"basic-addon2",children:"Start Date"}),e.jsx(b,{type:"date",id:"start date",placeholder:"Enter start date",value:u,onChange:s=>F(s.target.value)})]}),e.jsxs(T,{children:[e.jsx(V,{id:"basic-addon2",children:"End Date"}),e.jsx(b,{type:"date",id:"end date",placeholder:"Enter end date",value:o,onChange:s=>K(s.target.value)})]})]}),e.jsxs(T,{className:"mb-3",children:[e.jsx(V,{children:"$"}),e.jsx(b,{type:"number",id:"budget",placeholder:"Enter budget",value:v,onChange:s=>A(s.target.value)}),e.jsx(V,{children:".00"})]}),e.jsx(T,{className:"mb-3",children:e.jsxs(de,{"aria-label":"The Program Lead",onChange:s=>w(s.target.value),children:[e.jsx("option",{children:"Choose The Program Lead"}),t.map(s=>e.jsx("option",{value:s.username,children:s.username},s._id))]})}),e.jsx(E,{xs:{cols:"auto"},children:e.jsx(N,{xs:!0,className:"m-auto",children:e.jsx(f,{color:"primary",onClick:z,children:"Add Program"})})})]})})]}),e.jsx("div",{className:"text-end",children:e.jsx(f,{className:" mb-3",color:"primary",style:l.role==="superAdmin"?{}:{display:"none"},onClick:()=>R(!_),children:"Add Program"})}),e.jsx(k,{className:"mb-4",children:e.jsx(D,{children:e.jsx(E,{children:r.map((s,i)=>e.jsx(N,{xs:12,sm:6,md:4,lg:3,children:e.jsx(ke,{logo:s.logo,title:s.programTitle,path:`${window.location.pathname}/${s._id}`})},i))})})})]})}const vs=()=>{const a=L(t=>t.programsSlice.programs);return e.jsxs(ae,{children:[e.jsx(U,{path:"/",exact:!0,name:"Programs",element:e.jsx(Ze,{})}),a.map(t=>e.jsx(U,{name:t.programTitle,path:`/${t._id}/*`,element:e.jsx(We,{program:t})},t._id))]})};export{vs as default};
