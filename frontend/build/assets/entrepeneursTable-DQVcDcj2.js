import{r as c,j as e,h as G,L,o as R}from"./index-CAWvE-gF.js";import{C as k,a as _}from"./CCardBody-D4H8wrmY.js";import{C as D}from"./CCardHeader-GNJ1i-Nn.js";import{C as q}from"./CForm-BV2sRnqc.js";import{C as y,a as j}from"./CRow-DAiI0smK.js";import{C as g}from"./CFormControlWrapper-82qvSWnn.js";import{C as A}from"./CFormSelect-C0T30s8K.js";import{C as M}from"./CFormInput-D8oF0scl.js";import{a as f}from"./index.esm-Byw7YMbt.js";import{I as O,u as w,w as B}from"./importExport-vl0F6wc8.js";import{C as I}from"./CTable-Bbxtl6KS.js";import"./ReactToastify-DTQlESTW.js";const T=({entrepreneurs:l,onFilterUpdate:x})=>{const[n,m]=c.useState({sector:"",male:!0,female:!0,region:"",gouvernorat:"",search:""}),[C,E]=c.useState([]),[S,v]=c.useState([]),[b,N]=c.useState([]),[F,r]=c.useState(!0),[s,t]=c.useState([]);c.useEffect(()=>{const a=[...new Set(l.map(d=>d.secteurActivites))],u=[...new Set(l.map(d=>d.region))],p=[...new Set(l.map(d=>d.gouvernorat))];E(a),v(u),N(p)},[l]),c.useEffect(()=>{r(n.male||n.female)},[n.male,n.female]),c.useEffect(()=>{const a=l.filter(u=>Object.values(u).some(p=>p.toString().toLowerCase().includes(n.search.toLowerCase())));t(a)},[n.search,l]);const i=a=>{const{name:u,value:p}=a.target;m(d=>({...d,[u]:p}))},h=a=>{const{name:u,checked:p}=a.target;m(d=>({...d,[u]:p}))},o=a=>{a.preventDefault(),x(n)};return e.jsxs(k,{className:"mb-4 shadow",children:[e.jsx(D,{className:"bg-primary text-white",children:"Advanced Filter"}),e.jsx(_,{children:e.jsxs(q,{onSubmit:o,children:[e.jsxs(y,{className:"mb-3",children:[e.jsxs(j,{md:"4",children:[e.jsx(g,{htmlFor:"sector",children:"Sector"}),e.jsxs(A,{name:"sector",value:n.sector,onChange:i,children:[e.jsx("option",{value:"",children:"All Sectors"}),C.map(a=>e.jsx("option",{value:a,children:a},a))]})]}),e.jsxs(j,{md:"4",children:[e.jsx(g,{children:"Gender"}),e.jsxs("div",{children:[e.jsx("input",{type:"checkbox",id:"male",name:"male",checked:n.male,onChange:h}),e.jsx("label",{htmlFor:"male",className:"mx-2",children:"Male"}),e.jsx("input",{type:"checkbox",id:"female",name:"female",checked:n.female,onChange:h}),e.jsx("label",{htmlFor:"female",className:"mx-2",children:"Female"})]})]}),e.jsxs(j,{md:"4",children:[e.jsx(g,{htmlFor:"region",children:"Region"}),e.jsxs(A,{name:"region",value:n.region,onChange:i,children:[e.jsx("option",{value:"",children:"All Regions"}),S.map(a=>e.jsx("option",{value:a,children:a},a))]})]})]}),e.jsxs(y,{children:[e.jsxs(j,{md:"4",children:[e.jsx(g,{htmlFor:"ageMin",children:"Minimum Age"}),e.jsx(M,{type:"number",id:"ageMin",name:"ageMin",value:n.ageMin,onChange:i,min:"0",placeholder:"Min Age"})]}),e.jsxs(j,{md:"4",children:[e.jsx(g,{htmlFor:"ageMax",children:"Maximum Age"}),e.jsx(M,{type:"number",id:"ageMax",name:"ageMax",value:n.ageMax,onChange:i,min:"0",placeholder:"Max Age"})]}),e.jsxs(j,{md:"4",children:[e.jsx(g,{htmlFor:"gouvernorat",children:"Gouvernorat"}),e.jsxs(A,{name:"gouvernorat",value:n.gouvernorat,onChange:i,children:[e.jsx("option",{value:"",children:"All Gouvernorats"}),b.map(a=>e.jsx("option",{value:a,children:a},a))]})]})]}),e.jsx(y,{children:e.jsxs(j,{md:"12",children:[e.jsx(g,{htmlFor:"search",children:"Search"}),e.jsx("div",{className:"input-group",children:e.jsx(M,{type:"text",id:"search",name:"search",className:"form-control",placeholder:"Search...",value:n.search,onChange:i})})]})}),e.jsx(f,{type:"submit",color:"primary",className:"mt-3",disabled:!F,children:"Apply Filters"})]})})]})},P=({onExportAll:l,onExportSelected:x,selectedCount:n})=>{const m=()=>{l&&l()},C=()=>{x&&x()};return e.jsxs("div",{children:[e.jsxs("div",{children:[e.jsx(f,{color:"primary",className:"m-2",onClick:m,children:"Export All"}),e.jsx(f,{color:"primary",className:"m-2",onClick:C,children:"Export Selected"})]}),e.jsx("div",{children:e.jsxs("p",{children:[n," selected"]})})]})},ee=()=>{const l=G(r=>r.entrepreneurs.entrepreneurs),[x,n]=c.useState(l),[m,C]=c.useState([]);c.useEffect(()=>{n(l)},[l]);const E=r=>{let s=l;if(r.sector&&(s=s.filter(t=>t.secteurActivites===r.sector)),r.gender&&(s=s.filter(t=>t.gender===r.gender)),r.region&&(s=s.filter(t=>t.region===r.region)),r.ageMin&&(s=s.filter(t=>t.age>=r.ageMin)),r.ageMax&&(s=s.filter(t=>t.age<=r.ageMax)),r.gouvernorat&&(s=s.filter(t=>t.gouvernorat===r.gouvernorat)),r.search){const t=r.search.toLowerCase();s=s.filter(i=>Object.values(i).some(h=>typeof h=="string"&&h.toLowerCase().includes(t)))}n(s)},S=r=>{C(s=>s.includes(r)?s.filter(t=>t!==r):[...s,r])},v=(r,s)=>{const t=r.map(o=>({Nom:o.nom,Prénom:o.prenom,Adresse:o.adresse,Email:o.email,"Date de Naissance":o.dateDeNaissance,Région:o.region,Genre:o.gender,"Nom de Startup":o.startupName,Description:o.description,Gouvernorat:o.gouvernorat,"Secteur d'activités":o.secteurActivites,"Nombre de Cofondateurs":o.nombreCofondateurs,"Nombre de Cofondateurs Femmes":o.nombreCofondateursFemmes,"Créée ou Non":o.creeeOuNon,"Forme Juridique":o.formeJuridique,"Nombre d'emplois Créés":o.nombreEmploisCrees,"Coût du Projet":o.coutProjet})),i=w.json_to_sheet(t),h=w.book_new();w.book_append_sheet(h,i,"Entrepreneurs"),B(h,s)},b=()=>{v(l,"all_entrepreneurs.xlsx")},N=()=>{const r=x.filter(s=>m.includes(s._id));v(r,"selected_entrepreneurs.xlsx")},F=async r=>{try{console.log(r),await R.delete(`/deleteEntrepreneur/${r}`);const s=l.filter(t=>t._id!==r);n(s),C(t=>t.filter(i=>i!==r))}catch(s){console.error("Error deleting entrepreneur:",s)}};return e.jsxs("div",{children:[e.jsx(T,{entrepreneurs:l,onFilterUpdate:E}),e.jsxs("div",{className:"d-flex justify-content-end mt-2 ",children:[e.jsx(O,{}),e.jsx(P,{onExportAll:b,onExportSelected:N,selectedCount:m.length})]}),e.jsxs(k,{className:"mt-2",children:[e.jsx(D,{className:"bg-dark text-light",children:"Entrepreneurs"}),e.jsx(_,{children:e.jsxs(I,{responsive:!0,children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Entrepreneur Name"}),e.jsx("th",{children:"Startup Name"}),e.jsx("th",{children:"Activities Sector"}),e.jsx("th",{children:"Birthday"}),e.jsx("th",{children:"Mail"}),e.jsx("th",{})," "]})}),e.jsx("tbody",{children:x.map(r=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("input",{type:"checkbox",checked:m.includes(r._id),onChange:()=>S(r._id)})}),e.jsxs("td",{children:[r.nom," ",r.prenom]}),e.jsx("td",{children:r.startupName}),e.jsx("td",{children:r.secteurActivites}),e.jsx("td",{children:new Date(r.dateDeNaissance).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit"})}),e.jsx("td",{children:r.email}),e.jsxs("td",{children:[e.jsx(L,{to:`${r._id}`,children:e.jsx(f,{color:"primary",children:"See More"})}),e.jsx(f,{color:"danger",className:"m-1",onClick:()=>F(r._id),children:"Delete"})]})]},r._id))})]})})]})]})};export{ee as default};
